<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Brain - Intelligence Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/brain.css') }}">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="brain-header">
            <div class="header-left">
                <button class="back-btn" onclick="window.location.href='/'">
                    <i class="fas fa-arrow-left"></i>
                    Retour
                </button>
                <h1><i class="fas fa-brain"></i> AI Brain - Analyse Intelligente</h1>
            </div>
            <div class="header-right">
                <button class="start-analysis-btn" id="startAnalysisBtn" onclick="startSmartAnalysis()">
                    <i class="fas fa-microscope"></i>
                    Lancer l'Analyse Intelligente
                </button>
                <button class="reset-analysis-btn" id="resetAnalysisBtn" onclick="resetAnalysis()" style="display:none;">
                    <i class="fas fa-redo"></i>
                    Nouvelle Analyse
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="brain-main">
            <!-- Welcome Screen -->
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-content">
                    <i class="fas fa-brain welcome-icon"></i>
                    <h2>Analyse Intelligente Multi-Agents</h2>
                    <p>Ce système utilise plusieurs agents IA spécialisés pour analyser en profondeur vos données dentaires et découvrir des patterns, règles et insights cliniques.</p>
                    <div class="agents-preview">
                        <div class="agent-card scanner">
                            <i class="fas fa-search"></i>
                            <h4>Scanner</h4>
                            <p>Identifie les patterns intéressants</p>
                        </div>
                        <div class="agent-card analyzer">
                            <i class="fas fa-microscope"></i>
                            <h4>Analyzer</h4>
                            <p>Analyse en profondeur</p>
                        </div>
                        <div class="agent-card synthesizer">
                            <i class="fas fa-lightbulb"></i>
                            <h4>Synthesizer</h4>
                            <p>Génère des règles cliniques</p>
                        </div>
                        <div class="agent-card validator">
                            <i class="fas fa-check-circle"></i>
                            <h4>Validator</h4>
                            <p>Valide les découvertes</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Progress -->
            <div class="analysis-container" id="analysisContainer" style="display:none;">
                <!-- Progress Bar -->
                <div class="progress-section">
                    <div class="progress-header">
                        <h3>Progression de l'Analyse</h3>
                        <span class="progress-percentage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="current-stage" id="currentStage">Initialisation...</div>
                </div>

                <!-- Agent Thinking Visualization -->
                <div class="thinking-section">
                    <h3><i class="fas fa-brain"></i> Processus de Réflexion des Agents</h3>
                    <div class="thinking-container" id="thinkingContainer">
                        <!-- Agent thoughts will appear here in real-time -->
                    </div>
                </div>

                <!-- Discovered Rules -->
                <div class="discoveries-section">
                    <div class="discoveries-header">
                        <h3><i class="fas fa-lightbulb"></i> Règles et Insights Découverts</h3>
                        <div class="filter-buttons">
                            <button class="filter-btn active" onclick="filterRules('all')">Tous</button>
                            <button class="filter-btn" onclick="filterRules('high')">Haute Confiance</button>
                            <button class="filter-btn" onclick="filterRules('pattern')">Patterns</button>
                            <button class="filter-btn" onclick="filterRules('timing')">Timing</button>
                            <button class="filter-btn" onclick="filterRules('material')">Matériaux</button>
                        </div>
                    </div>
                    <div class="rules-grid" id="rulesGrid">
                        <!-- Rule cards will appear here as discovered -->
                    </div>
                </div>
            </div>

            <!-- Analysis Complete -->
            <div class="analysis-complete" id="analysisComplete" style="display:none;">
                <div class="complete-header">
                    <i class="fas fa-check-circle"></i>
                    <h2>Analyse Terminée</h2>
                    <p>L'analyse intelligente a découvert <span id="totalRules">0</span> règles et insights</p>
                </div>
            </div>
        </div>

        <!-- Rule Detail Modal -->
        <div class="modal" id="ruleModal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="ruleTitle">Titre de la Règle</h3>
                    <button class="close-btn" onclick="closeRuleModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="rule-detail">
                        <h4>Description</h4>
                        <p id="ruleDescription"></p>
                    </div>
                    <div class="rule-detail">
                        <h4>Raisonnement Clinique</h4>
                        <p id="ruleClinicalReasoning"></p>
                    </div>
                    <div class="rule-detail">
                        <h4>Preuves</h4>
                        <div id="ruleEvidence"></div>
                    </div>
                    <div class="rule-detail">
                        <h4>Exceptions</h4>
                        <div id="ruleExceptions"></div>
                    </div>
                    <div class="rule-confidence">
                        <span>Niveau de Confiance:</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="ruleConfidenceFill"></div>
                        </div>
                        <span id="ruleConfidenceValue">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='js/brain.js') }}"></script>
</body>
</html>